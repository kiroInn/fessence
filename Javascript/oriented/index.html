<html>
<head>
    <title>Object Oriented Programming</title>
</head>
<body>
<script>
    // Object Oriented Programming

    var carBrand = 'xx车';
    var carPrice = '100000';
    var carHighSpeed = '240km/h';
    var carRun = function () {
        console.log('running');
    }

    // var car = {
    //     brand: 'xx车',
    //     price: 100000,
    //     highSpeed: '240km/h',
    //     security: '4组安全气囊',
    //     settings: 'xxxx',
    //     run: function () {
    //         console.log('running');
    //     }
    // };
    //
    // console.log(car);
    //
    // delete car.brand;
    // console.log(car);
    //

    var car = {
        price: '100000',
        _speed: '0km/h'
    };
    // var property = {
    //     value: '100000',
    //     writable: true,
    //     enumerable: true,
    //     configurable: true
    // }

    // ECMAScript 5 的 Object.defineProperty() 方法
    Object.defineProperty(car, 'brand', {
        value: 'xx车'
    });
    delete car.brand;
    car.brand = 'yy车';
    for(var key in car){
        console.log(car[key]);
    }
    // defineProperties
    Object.defineProperties(car, {
        brand1: {
            writable: true,
            value: 'defaultBrand'
        },
        price: {
            writable: true,
            value: 'defaultPrice'
        }
    })

    car.price = 'notDefaultPrice';
    for(var key in car){
        console.log(key, car[key]);
    }
    // 使用defineProperty 与 {} 字面声明的区别？
    // 字面量 声明后 可以使用defineProperty 声明同一属性
    // defineProperty 声明后 不能继续通过defineProperty声明同一属性
    // {...} descriptor default value diff

    // car.brand         :       object get property  translate    car.price
    // car.brand = 'zz车': = 'zz车' set obj property

    Object.defineProperty(car, 'speed', {
        get: function () {
            console.log('hook get function');
            return this._speed
        },
        set: function (v) {
            console.log('hook set function');
            this._speed = v;
        }
    });

    // console.log(car.speed)
    car.speed = '300km/h'
    // Vue AngularJs React  => Event Listener Domain
    // 字面量 构造方法 new Object
    
    // 工厂模式
    function productionWater() {
        var water = {};
        water.brand = '哇哈哈矿泉水';
        water.volume = 600;
        water.xxx = 'xxx';
        return water;
    }

    var waterBox = {
        values: [],
        push: function (waterObj) {
            if(isWaterType(waterObj)){
                this.values.push(waterObj);
            }else{
                console.error('type err');
            }
        }
    };

    waterBox.push(productionWater());
    waterBox.push(productionWater());
    waterBox.push({volume: 'hack'});
    waterBox.values.forEach(function (water) {
        console.log(water);
    });


    function isWaterType(waterObj) {
        return waterObj.hasOwnProperty('volume') && typeof waterObj.volume === 'number'
    }

    var waterNewBox = {
        values: [],
        push: function (instance) {
            if(instance instanceof Water){
                this.values.push(instance);
            }else{
                console.error('type err');
            }
        }
    };

    waterNewBox.push(new Water('哇哈哈矿泉水', 600));
    waterNewBox.push(new Water('哇哈哈矿泉水', 600));
    waterNewBox.push(new Water('哇哈哈矿泉水', 600));
    waterNewBox.push(new Water('哇哈哈矿泉水', 600));
    waterNewBox.push({
        notWaterProp: 'not water'
    });

    waterNewBox.values.forEach(function (water) {
        console.log(water);
    })

    function Water(brand, volume, xxx) {
        this.brand = brand;
        this.volume = volume;
        this.xxx = xxx;
        this.drink = function () {
            console.log('drink now');
        }
    }
    //
    // function _Water(brand, volume, xxx) {
    //     obj.brand = brand;
    //     obj.volume = volume;
    //     obj.xxx = xxx;
    //     return obj;
    // }
    // function _newWaterProcess(){
    //     var obj = new Object();
    //     obj.__proto__ = Water.prototype;
    //     return _Water.call(obj);
    // }
    // new关键字  当我们使用new 会发生什么
    // var water1 = new Water('哇哈哈矿泉水', 600);
    //     innerObj = {brand: xxx, volume: xxx, __proto__: functiona : functiona {
    // }}
    var water2 = new Water('哇哈哈矿泉水', 600);
    var water3 = new Water('哇哈哈矿泉水', 600);
    var water4 = new Water('哇哈哈矿泉水', 600);
    // water1.brand

    // prototype 是每一个函数都有的一个属性(原型) 是一个指针 指向一个对象(heap)
    // 作用 对象有当前函数类型的所有实例共享的属性和方法
    // __proto__ 作用actual 在使用属性方法的一个查找属性


    // 作为图书管理者(bookManager)
    // 我期望高效的管理学校的图书(Book)
    // 日常工作(have)
    // 管理  借出书籍(borrow)
    // 管理  归还书籍(back)
    // 统计  在馆书籍(list)
    // 归还时候的书籍 一定是本馆借出的(new feature)

    function Book(uuid) {
        this.uuid = uuid;
        this.name = name;
    }
    var bookManager = {
        books: [],
        borrow: function (uuid) {
            
        },
        back: function (uuid) {
            
        },
        list: function () {

        }
    }

</script>
</body>
</html>